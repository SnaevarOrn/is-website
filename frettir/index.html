<!doctype html>
<html lang="is" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>√≠s.is ‚Äî Fr√©ttir</title>

  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/favicon.png" sizes="32x32">
  <link rel="icon" href="/favicon.png" sizes="16x16">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <meta name="theme-color" content="#ffffff" id="metaThemeColor">

  <link rel="stylesheet" href="/assets/css/base.css">
  <link rel="stylesheet" href="/assets/css/components.css">
  <link rel="stylesheet" href="/assets/css/pages/frettir.css">

  <script src="/assets/js/prefs.js"></script>
  <script>
  (function () {
    const t = (window.prefs && prefs.getTheme) ? prefs.getTheme() : (localStorage.getItem('theme') || 'light');
    const theme = (t === 'dark') ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', theme);

    const meta = document.getElementById('metaThemeColor');
    if (meta) meta.setAttribute('content', theme === 'dark' ? '#0b0f14' : '#ffffff');
  })();
  </script>
</head>

<body>
  <header class="page-header">
    <div class="ph-left">
      <button class="icon-btn" id="btnBack" aria-label="Til baka" title="Fors√≠√∞a">‚Üê</button>
      <div class="ph-title">
        <nav class="ph-tabs" aria-label="Fr√©ttasv√¶√∞i">
          <a class="ph-tab" href="/frettir/" data-tab="iceland">IS</a>
          <a class="ph-tab" href="/erlent/"  data-tab="world">üåê</a>
        </nav>
      </div>
    </div>

    <div class="ph-right">
      <!-- NEW: Theme button next to hamburger -->
      <button class="icon-btn" id="btnThemeToggle" aria-label="√ûema" title="√ûema">üåì</button>

      <!-- Hamburger now opens Settings (no menu panel) -->
      <button class="icon-btn" id="btnMenu" aria-label="Stillingar" title="Stillingar">‚ò∞</button>
    </div>

    <div class="ph-meta" aria-live="polite">
      <!-- Status + LoadMore side-by-side -->
      <span class="ph-status">
        <span id="statusText">Tilb√∫i√∞.</span>
        <button id="btnLoadMore"
                class="nm-plus"
                type="button"
                hidden
                title="S√¶kja meira"
                aria-label="S√¶kja meira">+</button>
      </span>

      <span id="statusSpinner" class="spinner sm" aria-hidden="true" hidden></span>
      <span id="loadProgressText" class="tiny muted ph-pct" hidden>0%</span>

      <span class="ph-dot">‚Ä¢</span>

      <span class="ph-updated">
        <span id="lastUpdated"></span>
        <!-- NEW: Refresh button next to last updated -->
        <button class="icon-btn" id="btnRefresh" type="button" aria-label="Endurhla√∞a" title="Endurhla√∞a">üîÑ</button>
      </span>

      <div class="progress ph-progress" id="loadProgress" hidden aria-label="Hle√∞sla">
        <div class="progress-bar" id="loadProgressBar" style="width:0%"></div>
      </div>
    </div>
  </header>

  <main class="page-main">
    <dialog class="settings" id="settingsDialog" aria-label="Stillingar">
      <form method="dialog" class="settings-card" id="settingsForm">
        <div class="settings-head">
          <div>
            <div class="settings-kicker">Fr√©ttir</div>
            <h2>Stillingar</h2>
          </div>
          <button class="icon-btn" id="btnCloseSettings" type="button" aria-label="Loka" title="Loka">‚úï</button>
        </div>

        <div class="settings-grid">
          <section class="settings-section">
            <div class="sec-head">
              <h3>Fj√∂lmi√∞lar</h3>
              <div class="sec-actions">
                <button type="button" class="seg-btn" id="btnSourcesAll">Allt</button>
                <button type="button" class="seg-btn" id="btnSourcesNone">Ekkert</button>
              </div>
            </div>
            <div class="checklist" id="sourcesList"></div>
          </section>

          <section class="settings-section">
            <div class="sec-head">
              <h3>S√≠a</h3>
              <div class="sec-actions">
                <button type="button" class="seg-btn" id="btnCatsAll">Allt</button>
                <button type="button" class="seg-btn" id="btnCatsNone">Ekkert</button>
              </div>
            </div>
            <div class="checklist" id="catsList"></div>
          </section>
        </div>

        <div class="settings-footer">
          <button type="button" class="pill-btn primary" id="btnSaveSettings">Vista</button>
          <button type="button" class="pill-btn" id="btnResetSettings">Endurstilla</button>
        </div>
      </form>
    </dialog>

    <section class="news-list" id="newsList" aria-label="Fr√©ttalisti"></section>

    <section class="empty" id="emptyState" hidden>
      <h2>Ekkert fannst</h2>
      <p class="muted">Veldu fleiri mi√∞la e√∞a slaka√∞u √° s√≠um.</p>
      <button class="pill-btn primary" id="btnEmptyOpenSettings" type="button">Stillingar</button>
    </section>

    <section class="error" id="errorState" hidden>
      <h2>Villa</h2>
      <p class="muted" id="errorMsg">Gat ekki s√≥tt fr√©ttir.</p>
      <button class="pill-btn primary" id="btnRetry" type="button">Reyna aftur</button>
    </section>

    <!-- Reading view modal -->
    <dialog class="reading" id="readingDialog" aria-label="Leshamur">
      <div class="reading-card" role="document">
        <div class="reading-head">
          <div class="reading-title-row">
            <h2 class="reading-title">
              <a id="readingTitleLink"
                 href="#"
                 target="_blank"
                 rel="noopener noreferrer"
                 referrerpolicy="no-referrer">
                <span id="readingTitle">Hle√∞‚Ä¶</span>
              </a>
            </h2>

            <span class="reading-site" id="readingSite">Fr√©tt</span>
          </div>

          <button class="icon-btn" id="btnCloseReading"
                  type="button" aria-label="Loka" title="Loka">‚úï</button>
        </div>

        <div class="reading-body" id="readingBody">
          <p class="muted">S√¶ki texta‚Ä¶</p>
        </div>

        <div class="reading-foot tiny muted" id="readingMeta"></div>
      </div>
    </dialog>
  </main>

  <script src="/assets/js/utils.js"></script>
  <script src="/assets/js/theme.js"></script>
  <script src="/assets/js/pages/frettir.js" defer></script>
</body>
</html>
